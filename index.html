<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shared Intent Arena</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Menu System -->
    <div id="menu-system" class="overlay">
        <!-- Screens will be injected here by menu.js -->
        <div id="landing-screen" class="glass-panel menu-screen">
            <h1>SHARED INTENT <span class="highlight">ARENA</span></h1>
            <p class="tagline">Deterministic. Hidden. Strategic.</p>
            <div class="primary-actions vertical">
                <button id="play-random-btn" class="glow-btn x-large">PLAY RANDOM</button>
                <button id="play-friend-btn" class="glow-btn x-large outline">PLAY WITH FRIEND</button>
                <button id="play-ai-btn" class="glow-btn x-large outline">TRAINING (AI)</button>
                <button id="landing-feedback-btn" class="glow-btn x-large outline">FEEDBACK</button>
            </div>
            <p class="footer-note">v0.6.0 | Playtest ready</p>
        </div>

        <div id="options-screen" class="glass-panel menu-screen hidden">
            <h2>SELECT MODE</h2>
            <div id="mode-list" class="primary-actions">
                <!-- Modes injected based on Feature Flags -->
            </div>
            <button class="back-btn">← BACK</button>
        </div>

        <div id="room-screen" class="glass-panel menu-screen hidden">
            <h2 id="room-title">FRIEND PLAY</h2>
            <div class="room-actions">
                <div id="create-room-zone">
                    <button id="create-room-btn" class="glow-btn">CREATE ROOM</button>
                    <p class="sub-text">Generate a 6-digit code for a friend.</p>
                </div>

                <div class="divider"><span>OR</span></div>

                <div id="join-room-zone">
                    <input type="text" id="room-input" placeholder="ENTER 6-DIGIT CODE" maxlength="6">
                    <button id="join-room-btn" class="glow-btn">JOIN ROOM</button>
                    <p id="room-error" class="error-text hidden"></p>
                </div>
            </div>
            <button class="back-btn">← BACK</button>
        </div>

        <div id="lobby-screen" class="glass-panel menu-screen hidden">
            <h2 id="lobby-title">ROOM LOBBY</h2>
            <div class="lobby-info">
                <div id="room-code-group">
                    <p>Room Code:</p>
                    <div id="display-room-code" class="huge-text">------</div>
                </div>
                <p class="waiting-animation">Waiting for opponent...</p>
                <div id="lobby-fallback-area" class="hidden">
                    <p class="sub-text">Taking too long?</p>
                    <button id="fallback-bot-btn" class="glow-btn">PLAY VS BOT</button>
                </div>
            </div>
            <button id="cancel-room-btn" class="back-btn">CANCEL</button>
        </div>
    </div>
    <div id="app">
        <header class="top-bar glass-panel">
            <div class="turn-info">TURN <span id="turn-num">1</span></div>
            <div id="phase-indicator" class="phase-display">PHASE: PLANNING</div>
            <div class="server-status">SERVER: <span class="status-dot green"></span> ONLINE</div>
        </header>

        <div class="main-layout">
            <!-- Left Panel: My Stats & Abilities -->
            <aside class="side-panel left-panel">
                <section id="my-stats-container" class="panel-section stats-card glass-panel">
                    <h2 id="my-role-label">MY STATS</h2>
                    <div id="p1-hud" class="player-hud p1">
                        <div class="stat-row">
                            <span class="label">HP</span>
                            <div class="bar-container">
                                <div id="p1-hp-bar" class="stat-bar hp"></div>
                            </div>
                            <span id="p1-hp-val" class="value">5/5</span>
                        </div>
                        <div class="stat-row">
                            <span class="label">NRG</span>
                            <div class="bar-container">
                                <div id="p1-nrg-bar" class="stat-bar nrg"></div>
                            </div>
                            <span id="p1-nrg-val" class="value">5/5</span>
                        </div>
                    </div>
                </section>

                <section class="panel-section glass-panel">
                    <h3>SHARED ABILITIES</h3>
                    <div id="ability-track" class="ability-list">
                        <!-- Injected -->
                    </div>
                </section>
            </aside>

            <!-- Center: The Grid -->
            <main class="grid-viewport">
                <div id="game-grid" class="grid-container">
                    <!-- Injected -->
                </div>

                <div id="overlay-message" class="overlay hidden">
                    <div class="glass-panel overlay-card">
                        <h2 id="overlay-text">READY?</h2>
                        <button id="next-phase-btn" class="glow-btn">START TURN</button>
                    </div>
                </div>
            </main>

            <!-- Right Panel: Opponent & Intent -->
            <aside class="side-panel right-panel">
                <section id="opp-stats-container" class="panel-section stats-card glass-panel">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <h2>OPPONENT</h2>
                        <span id="opp-status" class="status-indicator hidden">READY</span>
                    </div>
                    <div id="p2-hud" class="player-hud p2">
                        <div class="stat-row">
                            <span class="label">HP</span>
                            <div class="bar-container">
                                <div id="p2-hp-bar" class="stat-bar hp"></div>
                            </div>
                            <span id="p2-hp-val" class="value">5/5</span>
                        </div>
                        <div class="stat-row">
                            <span class="label">NRG</span>
                            <div class="bar-container">
                                <div id="p2-nrg-bar" class="stat-bar nrg"></div>
                            </div>
                            <span id="p2-nrg-val" class="value">5/5</span>
                        </div>
                    </div>
                </section>

                <section class="panel-section glass-panel">
                    <h3>INTENT QUEUE</h3>
                    <div id="intent-display" class="intent-box">
                        <div id="pending-action-card" class="action-card empty">
                            <span>NO ACTION SELECTED</span>
                        </div>
                        <div id="energy-preview" class="energy-preview-text">
                            COST: 0 | REMAINING: 5
                        </div>
                    </div>
                    <button id="commit-btn" class="commit-btn disabled">LOCK INTENT</button>
                </section>

                <section id="log-panel" class="panel-section log-panel glass-panel">
                    <h3>ACTION LOG</h3>
                    <div id="log-content">Match Start.</div>
                </section>
            </aside>
        </div>

        <footer class="action-bar-overlay">
            <div id="action-panel" class="action-dock">
                <div class="btn-group">
                    <button id="action-move" class="action-btn" data-type="move">MOVE <span
                            class="badge">1</span></button>
                    <button id="action-attack" class="action-btn" data-type="attack">ATTACK <span
                            class="badge">1</span></button>
                    <button id="action-defend" class="action-btn" data-type="defend">DEFEND <span
                            class="badge">1</span></button>
                </div>
                <div id="direction-pad" class="d-pad hidden">
                    <button id="dir-up" class="d-btn up" data-dir="up">▲</button>
                    <div class="d-middle">
                        <button id="dir-left" class="d-btn left" data-dir="left">◀</button>
                        <button id="dir-right" class="d-btn right" data-dir="right">▶</button>
                    </div>
                    <button id="dir-down" class="d-btn down" data-dir="down">▼</button>
                </div>
            </div>
            <button id="commit-btn-mobile" class="glow-btn mobile-commit disabled">LOCK INTENT</button>
            <button id="feedback-btn" class="mini-btn">FEEDBACK</button>
        </footer>
    </div>

    <!-- Feedback Modal -->
    <div id="feedback-modal" class="overlay hidden">
        <div class="glass-panel feedback-content">
            <h2>ARENA FEEDBACK</h2>
            <p class="sub-text">Help us improve the strategic experience.</p>

            <form id="feedback-form">
                <div class="form-group">
                    <label>NAME (OPTIONAL)</label>
                    <input type="text" id="fb-name" placeholder="Anonymous Arena Master">
                </div>

                <div class="form-group">
                    <label>CONTACT / EMAIL (OPTIONAL)</label>
                    <input type="text" id="fb-contact" placeholder="For follow-up questions">
                </div>

                <div class="form-group">
                    <label>RATING (1-5)</label>
                    <div class="rating-group">
                        <input type="radio" name="rating" value="1" id="r1"><label for="r1">1</label>
                        <input type="radio" name="rating" value="2" id="r2"><label for="r2">2</label>
                        <input type="radio" name="rating" value="3" id="r3"><label for="r3">3</label>
                        <input type="radio" name="rating" value="4" id="r4"><label for="r4">4</label>
                        <input type="radio" name="rating" value="5" id="r5" checked><label for="r5">5</label>
                    </div>
                </div>

                <div class="form-group">
                    <label>COMMENTS (REQUIRED)</label>
                    <textarea id="fb-comments" rows="4"
                        placeholder="What did you think of the turn resolution? Any bugs?"></textarea>
                </div>

                <div class="primary-actions">
                    <button type="submit" class="glow-btn">SUBMIT FEEDBACK</button>
                    <button type="button" id="close-feedback-btn" class="back-btn">CANCEL</button>
                </div>
            </form>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="js/config.js"></script>
    <script src="js/logic.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/menu.js"></script>
    <script src="js/feedback.js"></script>
    <!-- AI System -->
    <script src="js/players/Difficulty.js"></script>
    <script src="js/players/Evaluation.js"></script>
    <script src="js/players/Minimax.js"></script>
    <script src="js/players/BotPlayer.js"></script>

    <script src="js/game.js"></script>
</body>

</html>